$Id: README,v 1.4 2006-06-11 18:14:08 oops Exp $

libkrisp - Korea ISP library

작성: 김정균 2006.06.09 http://www.oops.org

libkrisp 는 한국의 ip address 에 대한 ISP 정보를 얻기 위한 라이브러리이다.
이 library 를 사용하기 위해서는 sqlite library 가 필요하며, sqlite2 또는 sqlite3
이 필요하다. sqlite2 와 sqlite3 이 동시에 설치가 되어 있으면, sqlite3 을 이용
하며, sqlite3 을 사용하는 것을 권장한다. (sqlite2 는 가끔 오동작을 한다.)

간단한 사용법은 아래와 같다. (자세한 사항은 'man 3 search' 를 참고한다.)

#include <krisp.h>
extern char dberr[1024];

int main (void) {
    struct db_argument db;
    struct netinfos isp;
    char *ip = "168.126.63.1";

    if ( kr_open (&db) ) {
        fprintf (stderr, "ERROR Connect: %s\n", dberr);
        return 1;
    }

	strcpy (isp.ip, ip);
    search (&isp, &db, NULL);

	kr_close (&db);

    printf ("%-15s %-15s %-20s %-15s %-15s %s\n",
            ip, isp.ip, isp.serv, isp.network, isp.broadcast, isp.org);

    return 0;
}

또한, configure 시에 --with-geoip 옵션을 이용하여 geoip 를 연동할 수 있다.
geoip 를 연동하면 국가 코드와 국가 이름이 netinfos structure 에 추가 된다.
netinfos structure 는 다음과 같이 구성이 되어 있다.

struct netinfos {
    char            key[16];
    char            ip[16];
    char            netmask[16];
    char            network[16];
    char            broadcast[16];
    char            org[128];
    char            serv[128];
#ifdef HAVE_LIBGEOIP
    char            code[4];
    char            nation[128];
#endif
};

geoip 를 추가하는 예제는 krisplookup.c 를 참고하기 바란다. 아주 간단한 소스
이다.
