krisp 에서 hostip database (http://hostip.info) 를 지원하기 위한 문서
---------------------------------------------------------------------

이 문서는 http://hostipo.info 에서 제공하는 데이터를 krisp 의 userdb 를 이용하여
사용하는 것을 위한 문서이다.

참고로 hostip database 를 사용하기 위해서는 libkrisp 를 sqlite3 모드로 사용 하기
를 권장 한다. hostip csv file 을 COPY 로 입력할 때 에러가 발생한다. sql query 로
만들어서 넣기에는 data 가 너무 많다.

또한, hostinfo 의 database 는 참고를 할 만하지만, 믿음직 스럽지는 않다는 것을 명
심하도록 한다. (품질이 상당히 떨어진다.)


1. 다운로드 hostip city CSV
   rsync -rltvz --progress hostip.info::hostip/csv/hip_ip4_city_lat_lng.csv ./

2. 이 문서가 있는 디렉토리의 hostip.php 를 실행한다. 이 스크립트를 실행하기 위해
   서는 mod_geoip (ftp://ftp.oops.org/pub/oops/php/extensions/mod_geoip/)가 필요
   하다.

   shell> php hostip.php hip_ip4_city_lat_lng.csv > hostip.csv

3. 중복 확인 및 제거 :
   hostip.php 를 실행하면 마지막에 결과로 중복된 longip 를 보여준다. host.csv 에
   서 중복된 longip 를 유일값으로 수정해 준다. 이 단계는 수작업을 해 줘야 한다.

5. user database 에 입력
   libkrisp/contrib/userdb/README 를 참고하여 database 를 생성한다.

6. data import
   sqlite3:
      sqlite> .import hostip.csv userdb

   sqlite2:
      sqlite> COPY userdb FROM 'hostip.csv' USING DELIMITERS '|';


