.TH SEARCH 1 "12 Jun 2006"
.UC 4

.SH 이름
search - libkrisp database 에서 IP 에 대한 정보를 검색하여 반환한다.

.SH 사용법
.I #include <krips.h>
.br
.I int search (struct netinfos *isp, struct db_argument *db, GeoIP *gi);

.SH 설명
search() 함수는 주어진 ip 또는 호스트이름에 대한 정보를 검색한다.
마지막 인자 GeoIP *gi 는 GeoIP 연동시에 사용이 된다. libkrisp 가 GeoIP 를
link 하고 있을 경우 사용을 하며, 사용하지 않을 경우에는 NULL 로 지정을
한다.

GeoIP 관련 주의할 것은, libkrisp 가 geoip 를 링크하지 않을 경우에는 마지막
인자를 무조건 NULL 로 지정을 해야 한다는 점이며, link 가 되어 있을 경우에는
사용하고 싶지 않을 경우, NULL 로 지정을 하며, 사용을 할 경우에는 다음과 같이
gi 를 정의해 주어야 한다.
.PP
.I #ifdef HAVE_LIBGEOIP
.br
.I gi = GeoIP_new (GEOIP_MEMORY_CACHE);
.br
.I #endif
.br
.I search (&isp, &db, gi);


.SH 반환값
성공시에 0을 반환하며, 실패시에 1을 반환한다. 검색 결과가 없는 것은 성공으로
간주를 한다.

.SH 예제
.nf
#include <krisp.h>
extern char dberr[1024];

int main (void) {
    struct db_argument db;
    struct netinfos isp;
    char *ip = "168.126.63.1";

    if ( search (&db) ) {
        fprintf (stderr, "ERROR Connect: %s\\n", dberr);
        return 1;
    }

#ifdef HAVE_LIBGEOIP
    gi = GeoIP_new (GEOIP_MEMORY_CACHE);
#endif

    strcpy (isp.ip, ip);
    search (&isp, &db, gi);

	kr_close (&db);

    printf ("%-15s %-15s %-20s %-15s %-15s %s\\n",
            ip, isp.ip, isp.serv, isp.network, isp.broadcast, isp.org);

#ifdef HAVE_LIBGEOIP
    printf ("NATION : %s (%s)\\n", isp.nation, isp.code);
#endif

    return 0;
}
.fi

.SH 저자
김정균

.SH 버그 리포트
<http://www.oops.org> 의 QnA 게시판을 이용한다.

.SH 저작권
Copyright (c) 2006 OOPS Development Organization

이 프로그램은 LGPL 을 따르며, 사용시의 어떠한 문제에 대하여 보증하지 않는다.

.SH "참고"
krispmkdb(1), krispmkdb(1), krisp_version(3), kr_close(3), search(3)
